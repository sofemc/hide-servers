(function(f,b,$,v,z,o,y,O,s,g,Be,a,E,N,R){"use strict";const U=a.findByStoreName("ThemeStore");a.findByProps("triggerHaptic");const D=a.findByProps("colors","unsafe_rawColors"),j=D?.internal??D?.meta,W=a.findByProps("TextStyleSheet").TextStyleSheet,{View:p,Text:M,Pressable:Q}=g.General;a.findByProps("TableRow"),a.findByProps("ActionSheet")?.ActionSheet??a.find(function(e){return e.render?.name==="ActionSheet"});const X=a.findByProps("openLazy","hideActionSheet"),{openLazy:Ae,hideActionSheet:Y}=X;a.findByProps("ActionSheetTitleHeader","ActionSheetCloseButton","ActionSheetContentContainer"),a.findByProps("ActionSheetRow")?.ActionSheetRow;const m=a.findByName("Navigator")??a.findByProps("Navigator")?.Navigator,C=a.findByProps("getRenderCloseButton")?.getRenderCloseButton??a.findByProps("getHeaderCloseButton")?.getHeaderCloseButton,{popModal:K,pushModal:q}=a.findByProps("popModal","pushModal"),T=a.findByProps("useSearchControls"),w=a.findByProps("useSettingSearchQuery"),J=a.findByName("SettingSearchBar");a.findByProps("SvgXml"),a.findByProps("useInMainTabsExperiment","isInMainTabsExperiment"),a.find(function(e){return e?.WebView&&!e.default}).WebView,a.findByProps("Button","SegmentedControl");function Z(e){let i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:U.theme;return j.resolveSemanticColor(i,e)}function _(e,i){const n=Symbol("empty");if(!m||!C)return E.showToast(`${[m?n:"Navigator",C?n:"modalCloseButton"].filter(function(l){return l!==n}).join(", ")} is missing! Please try reinstalling Revenge`,s.getAssetIDByName("Small"));q({key:e,modal:{key:e,modal:i,animation:"slide-up",shouldPersistUnderModals:!1,closable:!0}})}Object.assign(function(e){let{searchContext:i,controls:n}=e;return o.React.createElement(o.ReactNative.ScrollView,{scrollEnabled:!1},o.React.createElement(T.default,{searchContext:i,controls:n},o.React.createElement(J,null)))},{useAdvancedSearch:function(e){const i=w.useSettingSearchQuery(),n=T.useSearchControls(e,!1,function(){});return o.React.useEffect(function(){return function(){w.setSettingSearchQuery(""),w.setIsSettingSearchActive(!1)}},[]),[i,n]}});function ee(e){return!m||!C?null:o.React.createElement(m,{initialRouteName:e.mkey,screens:{[e.mkey]:Object.assign(N.without(e,"mkey","children"),{headerLeft:C?.(function(){return K(e.mkey)}),render:function(){return e.children}})}})}function te(e){let{title:i,onPress:n,icon:l}=e;const t=o.stylesheet.createThemedStyleSheet({androidRipple:{color:y.semanticColors.ANDROID_RIPPLE},icon:{height:18,tintColor:y.semanticColors.HEADER_SECONDARY,opacity:.5}}),r=n?Q:p;return o.React.createElement(r,{android_ripple:t.androidRipple,disabled:!1,accessibilityRole:"button",onPress:n,style:{marginBottom:8,flexDirection:"row",justifyContent:"flex-start",alignItems:"center"}},l&&o.React.createElement(p,{style:{marginRight:4}},o.React.createElement(o.ReactNative.Image,{style:t.icon,source:l,resizeMode:"contain"})),o.React.createElement(P,{variant:"text-sm/semibold",color:"HEADER_SECONDARY"},i))}function ne(e){let{title:i,onTitlePress:n,icon:l,children:t,padding:r}=e;const S=o.stylesheet.createThemedStyleSheet({main:{backgroundColor:y.semanticColors.CARD_PRIMARY_BG,borderRadius:16,overflow:"hidden",flex:1}});return o.React.createElement(p,{style:{marginHorizontal:16,marginTop:16}},o.React.createElement(te,{title:i,onPress:n,icon:l}),o.React.createElement(p,{style:S.main},r?o.React.createElement(p,{style:{paddingHorizontal:16,paddingVertical:16}},t):t))}var H;(function(e){function i(l){let{children:t,onPress:r}=l;return o.React.createElement(P,{variant:"text-md/bold",onPress:r},t)}e.Bold=i;function n(l){let{children:t,onPress:r}=l;return o.React.createElement(M,{style:{textDecorationLine:"underline"},onPress:r},t)}e.Underline=n})(H||(H={}));function P(e){let{variant:i,lineClamp:n,color:l,align:t,style:r,onPress:S,getChildren:me,children:Ce,liveUpdate:we}=e;const[Ne,k]=o.React.useReducer(function(I){return~I},0);return o.React.useEffect(function(){if(!we)return;const I=new Date().setMilliseconds(1e3);let V;const Pe=setTimeout(function(){k(),V=setInterval(k,1e3)},I-Date.now());return function(){clearTimeout(Pe),clearInterval(V)}},[]),o.React.createElement(M,{style:[i?W[i]:{},l?{color:Z(y.semanticColors[l])}:{},t?{textAlign:t}:{},r??{}],numberOfLines:n,onPress:S},me?.()??Ce)}var d;(function(e){e[e.Folder=0]="Folder",e[e.Guild=1]="Guild"})(d||(d={}));const{View:re}=g.General,{FormRow:ie}=g.Forms,{showSimpleActionSheet:oe}=a.findByProps("showSimpleActionSheet"),ae=a.findByStoreName("SortedGuildStore"),le=a.findByStoreName("GuildStore"),de="#5865f2",G=function(){v.useProxy(c);const[e,i]=o.React.useState(""),n=le.getGuilds(),l=ae.getGuildFolders().filter(function(t){return t.folderId?u(d.Folder,t.folderId):t.guildIds.every(function(r){return u(d.Guild,r)})}).map(function(t){const r=t.folderId?t:n[t.guildIds[0]];if(r)return{id:r.folderId??r.id,name:r.folderName??r.name,icon:r.icon,color:r.folderId&&(r.folderColor?o.ReactNative.processColor(r.folderColor):de),type:r.folderId?d.Folder:d.Guild}}).filter(function(t){return t&&(t.name??"Unnamed").toLowerCase().includes(e)});return o.React.createElement(o.ReactNative.FlatList,{ListHeaderComponent:o.React.createElement(g.Search,{style:{marginBottom:10},onChangeText:function(t){return i(t.toLowerCase())}}),style:{paddingHorizontal:10,paddingTop:10},contentContainerStyle:{paddingBottom:20},data:l,renderItem:function(t){let{item:r}=t;return o.React.createElement(ie,{label:r.name,leading:r.icon?o.React.createElement(o.ReactNative.Image,{source:{uri:`https://cdn.discordapp.com/icons/${r.id}/${r.icon}.${r.icon.startsWith("a_")?"gif":"png"}?size=32`},style:{height:32,width:32,borderRadius:16}}):o.React.createElement(re,{style:{height:32,width:32,borderRadius:8,backgroundColor:r.color}}),onPress:function(){return oe({key:"CardOverflow",header:{title:r.name,onClose:Y},options:[{label:"Remove",icon:s.getAssetIDByName("ic_message_delete"),isDestructive:!0,onPress:function(){E.showToast(`Removed ${r.name} from hidden list`,s.getAssetIDByName("ic_hide_password")),x(r.type,r.id)}}]})}})},removeClippedSubviews:!0})};function se(e){e.push("VendettaCustomPage",{title:"Manage Hidden Servers",render:G})}const{ScrollView:ce}=g.General,{FormRow:h}=g.Forms,ue=o.stylesheet.createThemedStyleSheet({destructiveIcon:{tintColor:y.semanticColors.TEXT_DANGER}}),fe={color:"TEXT_DANGER",variant:"text-md/semibold"};function ge(){const e=o.NavigationNative.useNavigation();return React.createElement(ce,null,React.createElement(ne,{title:"Data",icon:s.getAssetIDByName("ic_cog_24px")},React.createElement(h,{label:"Manage hidden servers",leading:React.createElement(h.Icon,{source:s.getAssetIDByName("ic_message_edit")}),trailing:React.createElement(h.Arrow,null),onPress:function(){return se(e)}}),React.createElement(h,{label:React.createElement(P,fe,"Clear hidden servers"),leading:React.createElement(h.Icon,{style:ue.destructiveIcon,source:s.getAssetIDByName("ic_message_delete")}),trailing:React.createElement(h.Arrow,null),onPress:function(){return O.showConfirmationAlert({title:"Clear data",content:`Are you sure you want to clear **${c.list.length}** hidden server(s)?`,confirmText:"Clear",confirmColor:"red",onConfirm:function(){return c.list=[]},isDismissable:!0})}})))}function he(e){let{ret:i}=e;v.useProxy(c);const n=N.findInReactTree(i,function(t){return t?.type?.name==="Guilds"})?.props;if(!n)return;const l={guilds:[],folders:[]};for(const t of n.guildFolders)if(u(d.Folder,t.folderId)){l.folders.push(t.folderId);for(const r of t.guildIds)l.guilds.push(r)}else for(const r of t.guildIds.filter(function(S){return u(d.Guild,S)}))l.guilds.push(r);for(const t of l.guilds)n.unreadGuilds.delete(t),delete n.guildReadStates[t];return n.guildFolders=n.guildFolders.filter(function(t){return t.folderId?!u(d.Folder,t.folderId):!0}).map(function(t){return{...t,guildIds:t.guildIds.filter(function(r){return!u(d.Guild,r)})}}),i}function F(){return React.createElement(ee,{mkey:"MANAGE_HIDDEN_SERVERS",title:"Manage Hidden Servers"},React.createElement(G,null))}const{default:ye}=a.find(function(e){return e?.default?.render?.name==="GuildPopoutMenu"}),{default:Re}=a.find(function(e){return e?.default?.render?.name==="FolderPopoutMenu"}),pe=a.findByName("GuildsConnected",!1);function Se(){const e=new Array;return e.push(R.after("render",ye,function(i,n){let[{guildId:l,title:t}]=i;const r={...n};return u(d.Guild,l)||r.props.rows.unshift({text:"Hide Server",icon:s.getAssetIDByName("ic_hide_password"),onClick:function(){B(d.Guild,l),E.showToast(`Hid ${t}`,s.getAssetIDByName("ic_hide_password"))}}),r})),e.push(R.after("render",Re,function(i,n){let[{title:l,folderId:t}]=i;const r={...n};return u(d.Folder,t)||r.props.rows.unshift({text:"Hide Folder",icon:s.getAssetIDByName("ic_hide_password"),onClick:function(){B(d.Folder,t),E.showToast(`Hid ${l}`,s.getAssetIDByName("ic_hide_password"))}}),r})),e.push(R.after("default",pe,function(i,n){return o.React.createElement(he,{ret:n})})),e.push(R.before("TouchableWithoutFeedback",o.ReactNative,function(i){const n=[...i];return n[0].accessibilityLabel===o.i18n?.Messages?.DIRECT_MESSAGES&&(n[0].onLongPress=function(){return _("MANAGE_HIDDEN_SERVERS",F)}),n})),e.push(R.before("render",metro.findByName("Pressable"),function(i){const n=[...i];return n[0].accessibilityLabel==="Create or join a server"&&(n[0].onLongPress=function(){return _("MANAGE_HIDDEN_SERVERS",F)}),n})),function(){return e.forEach(function(i){return i()})}}const c=v.wrapSync(v.createStorage({get:function(){return b.storage.hidden??{list:[]}},set:function(e){b.storage.hidden=e}}));function u(e,i){return c.list.some(function(n){return n[0]===e&&n[1]===i})}function B(e,i){u(e,i)||(c.list=[...c.list,e===d.Folder?[e,i]:[e,i]])}function x(e,i){c.list=c.list.filter(function(n){return n[0]!==e||n[1]!==i})}const A=Symbol.for("vendetta.storage.emitter"),ve=!!$.plugins[A]&&!!z.themes[A];let L;var Ee={onLoad:function(){return L=Se()},onUnload:function(){return L?.()},settings:ge};return f.addHidden=B,f.default=Ee,f.emitterAvailable=ve,f.emitterSymbol=A,f.hiddenList=c,f.isHidden=u,f.removeHidden=x,Object.defineProperty(f,"__esModule",{value:!0}),f})({},revenge.plugin,revenge.plugins,revenge.storage,revenge.themes,revenge.metro.common,revenge.ui,revenge.ui.alerts,revenge.ui.assets,revenge.ui.components,revenge,revenge.metro,revenge.ui.toasts,revenge.utils,revenge.patcher);
